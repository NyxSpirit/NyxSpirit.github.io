<html>
<head>
    
    <meta charset='utf8'>
    
    <title>滚动新闻(FakeNyx)</title>
    
    <link rel='stylesheet' type='text/css' href='css/NewsPage.css'>
    
    <script type="text/javascript" src="http://learn.cic.tsinghua.edu.cn:80/res/common/js/library/jquery/jquery-1.7.2.min.js"></script>

<script type="text/javascript">

    $('document').ready(LoadNews());
    var json;
    var curNews = 0;
    var curSliderPos = 0;

    function setCurrent(value) {        
        var mainNews = $("img.mainPic");
        mainNews[0].src = json.newsInfo[value].picUrl;
        $('div.newsTitle')[0].innerHTML = '<a href = ' + json.newsInfo[value].detailUrl + '>' + json.newsInfo[value].title + '</a>';
        curNews = value;
    }

    function LoadNews(){
        var xmlhttp;

        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest(); 
        }
        else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                json = eval("(" + xmlhttp.responseText + ")");

                var mainNews = $("<img class = 'mainPic'/>");
                mainNews[0].src = json.newsInfo[0].picUrl;
                $('div.mainPic').append(mainNews);
                $('div.newsTitle')[0].innerHTML = '<a href = ' + json.newsInfo[0].detailUrl + '>' +json.newsInfo[0].title + '</a>';
                curNews = 0;

                var picSec = $('div.abbrPics');
				for (i in json.newsInfo) {
				    var newpic = $("<img/>");
				    newpic[0].src = json.newsInfo[i].picUrl;
				    newpic.css('left',5);
				    newpic.css('top',0)
				    newpic.css('position','relative');
				    newpic.addClass('abbrPic');
				    picSec.append(newpic);
				}
		picSec.css('left',0);
		picSec.css('position','relative');
            }
        }
        var url = './NewsSrc.json';
        xmlhttp.open("GET", url, true);
        xmlhttp.send();
    }

    function SlideOn() {
        if (curNews < json.totalNumber - 1) setCurrent(curNews + 1);
        else setCurrent(0);
        setTimeout('SlideOn()', 2000);
    }
    
    function picSlideBack() {
        var slider = $('div.abbrPics');
        if (curSliderPos <= -175) {
            curSliderPos = curSliderPos + 175;
            slider.animate({left:  (String(curSliderPos) + 'px')}, 'slow');
        }
    };
    function picSlideNext() {
        var slider = $('div.abbrPics');
        if (curSliderPos >= -175*(json.totalNumber-1)){
            curSliderPos = curSliderPos - 175;
            slider.animate({left:  (String(curSliderPos) + 'px')}, 'slow');
        }
    };

    setTimeout('SlideOn()', 2000);
    
</script>
</head>

<body>
    <aside class ="commentSection">
        <div class ="showComment">
            <p class ="center">显示评论</p>
        </div>
        <div class ="addComment">
            <h1>添加评论</h1>
            <input />
        </div>
        <div class ="otherFunc">
            <h1>分享</h1>
        </div>
    </aside>   
    <section class="picSection">
        <div class="prevNews">
            上一张
        </div>
        <div class="mainPic">
            <div class="newsTitle">
                <a>No News Now.</a>
            </div>
        </div>       
        <div class="nextNews">
            下一张
        </div>
           
        <div style ="clear:both"></div>
        
        <div class="prevGroup" onclick ="picSlideBack()" style = "cursor:'pointer'">
            上一批
        </div>
        <div class="nextGroup" onclick ="picSlideNext()">
            下一批
        </div>
        <div class="slider">
        <div class="abbrPics">
            
        </div>
        </div>
    </section>




</body>
</html>

